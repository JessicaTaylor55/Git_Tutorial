---
title: "Chapter 12: Git and GitHub"
author: "Jessica Taylor and Nora Honkomp"
date: "2022-11-12"
output: 
  html_document:
    toc: true
    toc_float: true
bibliography: bibliography.bib
link-citations: yes
---
Most of this comes from @Gandrud_2015.

# Getting Started

## Create a GitHub Account

## Installing Git

## Introduce Yourself to Git in R

## DONT BREAK R!!

## Basic Structure

((maybe explain what a repository is and about README files?))


# Version Control (with Git)

The main functionality of Git is version control. This means Git will save all the previous versions of your files so it is easy to go back and see how things were before. In order for this to work effectively, you need to frequently save versions of your work.

## Setting Up a Local Repository
You can create a repository that is located only on your device (therefore it is considered "local"). This will allow you to track changes in a project on your computer and access previous versions of the document at any time. We will look at how to create a local repository using Rstudio, but know that it is also possible to do this using the terminal.
(See page 96 of @Gandrud_2015)

1. In Rstudio, select `File` in the top left corner, and then `New Project`\
2. When the New Project menu appears, select `New Directory`\

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/new_directory.PNG")
```

3. On the following screen, select `New Project`\
4. Finally, type the name you want to use for your new project, browse to the location where you want it saved on your computer, and select the `Create a git repository` box.\

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/create_git_repository.PNG")
```

You now have a folder with a `.Rproj` object and a `.gitignore` file. 

## "Adding" and "Committing"

You can create or bring in any files (including your data) to this project folder, and Git will track changes made to them. In order to do this, you will need to "add" files that have been changed and "commit" these changes.

Once you are satisfied with the changes you have made and saved any changed files, you will "add" those files to your commit by checking the boxes in the `Git` tab in your Rstudio window.

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/adding.PNG")
```

In order to save a version of your project as it is right now (with these added files), you will need to "commit". To do this, select the `Commit` button, above the boxes you just checked. This will open a new window where you can see the list of files that you added. 

Type a useful message in the `Commit Message` box briefly describing the changes you made in this version. Then hit `Commit`.

``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/committing.PNG")
```

You should see a window pop up telling you what changes were successfully made. If this window ever says "failed", "execution halted", or "aborted", this means the commit did not work and you should read the message closely to determine why. 

Save, add, and commit frequently in order to get the most use out of your version control.

## "Branches" and "Merging"

If you want to try some changes to your files without totally committing to them yet (i.e. test run some code) you can create a branch. This will allow you to make changes to your files while maintaining an unchanged copy on the main branch. 

To create a branch, select the button with small purple shapes on the right hand side of your `Git` tab in Rstudio. 


``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/branch_button.PNG")
```

You can now create a new branch, for example one called "test". This is essentially a copy of everything that is in your repository, and making changes here will not affect the original copy, called the "main" branch.

To switch between branches, select the drop down menu to the right of the button you used to create a new branch. 

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/branches.PNG")
```

You can easily switch to a different branch by selecting it on this menu.

Note that any files you create on a side branch will not show up in the main branch.

You can have multiple branches coming off your main branch at once, so you can try multiple different approaches simultaneously. But, anytime you make a new branch, it will start as a duplicate of the main branch.

You can see a history of your commits on different branches by selecting the clock icon (designating "History") near the `commit` button on your `Git` tab. You will initially see the history for only one of your branches, but if you select the drop down menu of branches at the top of this window, you can select `all branches` and see how the branches compare to one another.

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/history_button.PNG")

```


If you find a method that works in a side branch and you want to bring it in to the main branch, this is called a merge. 

To merge a side branch with the main branch (changing the version of your repo present main branch to match that of the successful side branch), we will use the terminal. 

1. Make sure you are on the `main` branch\
2. select the `Terminal` tab next to the `Console` tab in the section of Rstudio displaying your console. \
3. type `git merge ` and then the name of the branch you want to merge into the main branch. \

``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/merge_terminal.PNG")

```

The repository of your main branch should now match the repository of whatever branch you merged with it. 

One way to check if the branches merged he way you intended is to select the history button again (make sure you go to `all branches`) and check that the "HEAD" (which is the main branch) is at the same level as whichever branch you merged it with.

# Remote Storage/Collaboration (with GitHub)

With GitHub, you can set up a repository that is accessible from the internet (referred to as "remote") and  can be accessed by other people. Remote repositories are nice because you can access them from different computers, assuming you have internet access, giving you access to your project wherever you are and creating a back up in case something happens to your computer. Github also allows for structured collaboration, so your whole team can make edits on the same documents and keep track of what has been changed where..

## Setting Up Remote Repositories

To set up a remote repository, make sure you are able to log into GitHub. We will go over three different way to make repositories: starting from scratch with a new repository, creating a repository for an already started project, and accessing a repository made by a collaborator.

### New Repository

To create a brand new repository, click on the plus sign near your profile picture in the top right corner of GitHub and select `New repository`.

``` {r, echo = FALSE, out.width = '40%', fig.align = 'center'}

knitr::include_graphics("images/your_repository.PNG")
```


On the next page, type in a name for your repository and choose whether you want it to be public or private. It is recommended you select the box to create a README file. This will give you a place to describe the layout of your repository and the purpose of each file. Without a README file, visitors to your repository (and maybe future you) might not be able to figure out how to properly use the files in your repository, leading to your working being non-reproducible.

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/readme.PNG")
```

Now you can click `Create Repository`.

Once your repository is created, you will see only the README file is present. To create other files, let's create a directory for this repo on our computer. 

1. In R studio, follow the instructions for creating a new project, but when you see the following menu, select `Version Control` this time.\

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/version_control_directory.PNG")
```

2. On the next window, select `Git`.\
3. Return to the GitHub page for the repository you created and select the green `Code` button.\
4. Copy the HTTPS link from the menu that pops up.

``` {r, echo = FALSE, out.width = '50%', fig.align = 'center'}

knitr::include_graphics("images/repo_link.PNG")
```

5. Return to Rstudio and past the link in the Repository URL line at the top of the popped up window. Make sure to check the file path that is currently set and use the `Browse` button if you want to save the folder for this directory in a different place.

``` {r, echo = FALSE, out.width = '60%', fig.align = 'center'}

knitr::include_graphics("images/clone_repo.PNG")
```

Your repository is now set up in a new project in Rstudio, and you can begin by creating an Rmarkdown, R Script, etc.

Note, you can edit the contents of the README file by opening it in Rstudio.

### From an Existing Project

You may find yourself wanting to create a repo on GitHub for a project you have already started working on. Fortunately it is easy to start version control tracking on a project and add the project to a remote repository. 

Here are the steps to follow if you have a project folder with a `.Rproj` file in it and your directory is not already being tracked with Git:

1. follow the steps above for creating a New repository, but this time do not click the box to create a README file. This will bring you to a page with a "Quick Set Up" link. Keep this page open for later.\

``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/quick_setup.PNG")
```

2. Navigate to the existing directory that you are trying to add to GitHub and open the `.Rproj` file./
3. Select the `Terminal` tab next to `Console` and enter the following lines of code.

``` {bash, eval =  FALSE}
$ git init -b main
```
"git" tells bash what program we want to use \ 
"init" tells bash to initialize a Git repository fir this directory \
"-b main" is saying we want to create a branch called "main" \

```{bash, eval = FALSE}
$ git add .
```

This will add all of the files within the current folder to the repository.
You may get a lot of warnings because you have a `.Rproj` file and potentially a `.Rhistory` file in this folder which are not usually ideal to track. We will take care of this by adding these file names to the .gitignore file shortly. 

``` {bash, eval = FALSE}
$ git commit -m "First commit"
```

This line creates your first commit. You can change the commit message to anything that makes sense to you.

4. Go back to GitHub and copy the Quick start link. Type the following code in the terminal, but replace `<REMOTE_URL>` with the copied link.

```{bash, eval = FALSE}
$ git remote add origin <REMOTE_URL>
# Replace "<REMOTE_URL>" with url from GitHub
```

5. Last, we will push these changes to GitHub. We will further discuss what this means later, but for now run the followin line in the terminal.

```{bash, eval = FALSE}
$ git push orgin main
```

Now when you return to GitHub and refresh your repository page, you should see all of the files from your existing project.

You can add a `README` and `.gitignore` on the GitHub website by selecting "Add file" on the repository's page. When you make a .gitignore file, it may suggest you use a template, in which case, select the `R` template from the drop down list and it will automatically fill the document with file types that should typically not be tracked.

### Cloning a Repository

If you want to join a repository that has already been created, you can either find the repository by searching for it on GitHub (if it is publicly available) or contact the creator and have them add you as a collaborator to the repository. Either way, you will follow steps 1-5 in teh "New Repository" section above, but this time the link is coming from the already created repository. 

In cases where the repository is not accessible (you do not have cloning priveledges), you will have to create a pull request. 


## "Pushing" and "Pulling"

Once you have your remote repository ready, you can make changes to the files and "add" and "commit" them like we did in the "Version Control" section above. However, now we must take steps to make sure our local version of the repository is up-to-date with the online version, and the versions that all other collaborators have on their computers. 

To do this, we will need to push and pull. "Pulling" is when we bring recent and out-of-sync changes from the online version to our local device. "Pushing" is the opposite; we are sending our commits to the online version to update it with our recent changes. This will allow anyone else working in the repository to pull your changes onto their computer.

To push and pull, use the blue and green arrows on the `Git` tab in R studio.

``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/push_pull_buttons.PNG")
```

You may also notice the next time you "commit" your changes, these same push and pull buttons are located above the "Commit Message" box on the pop up window. 

It is good practice to pull each time you are about to start working in a repository and to push after you commit, or at least before once at the end of your working period within a repository for the day. Keeping good push and pull habits will help you avoid merge conflicts with collaborators or yourself if you work on a project on more than one computer.

## Adding and Managing Collaborators

Collaborative coding is a huge benefit of GitHub. In order to invite your collaborators to clone your remote repository, you will need to know their GitHub username, or at least their email address. 

1. On your repository page on GitHub, select `Settings` in the middle of the banner near the top of the page. 

``` {r, echo = FALSE, out.width = '80%', fig.align = 'center'}

knitr::include_graphics("images/settings_button.PNG")
```

2. In the menu on the left, select the `Collaborators` page.

``` {r, echo = FALSE, out.width = '40%', fig.align = 'center'}

knitr::include_graphics("images/collaborators.PNG")
```

3. Enter your password, and then select `Add People` under `Manage Access`

Add your collaborators one at a time. This will send them a message inviting them to join the repository. 

As the owner of the repository, you will be able to remove people from the repository at any time.

## "Merge Conflicts"

# Extras

## "gitignore" and Large Files

## "Amend Commits"

## Recovering old versions

((this might get covered in the version control section?))

## "Tags"

# References

<div id="refs"></div>

